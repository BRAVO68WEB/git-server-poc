{
  "openapi": "3.0.3",
  "info": {
    "title": "GitHut - Git Server API",
    "description": "A self-hosted Git server API that provides repository management, authentication, and Git Smart HTTP protocol support.",
    "version": "1.0.0",
    "contact": {
      "name": "Bravo68Web"
    },
    "license": {
      "name": "MIT"
    }
  },
  "servers": [
    {
      "url": "http://localhost:8080",
      "description": "Local development server"
    }
  ],
  "tags": [
    {
      "name": "Health",
      "description": "Health check endpoints"
    },
    {
      "name": "Authentication",
      "description": "User authentication and registration"
    },
    {
      "name": "Repositories",
      "description": "Repository management operations"
    },
    {
      "name": "Branches",
      "description": "Branch management operations"
    },
    {
      "name": "Tags",
      "description": "Tag management operations"
    },
    {
      "name": "Git Protocol",
      "description": "Git Smart HTTP protocol endpoints"
    }
  ],
  "paths": {
    "/": {
      "get": {
        "tags": ["Health"],
        "summary": "Health check",
        "description": "Returns the health status of the API",
        "operationId": "healthCheck",
        "responses": {
          "200": {
            "description": "API is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string",
                      "example": "Git Server API"
                    },
                    "status": {
                      "type": "string",
                      "example": "healthy"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/register": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Register a new user",
        "description": "Creates a new user account",
        "operationId": "registerUser",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "User registered successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegisterResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request body",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "User already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/me": {
      "get": {
        "tags": ["Authentication"],
        "summary": "Get current user",
        "description": "Returns the currently authenticated user's information",
        "operationId": "getCurrentUser",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }],
        "responses": {
          "200": {
            "description": "Current user information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserInfo"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/change-password": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Change password",
        "description": "Changes the password for the authenticated user",
        "operationId": "changePassword",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChangePasswordRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password changed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Password changed successfully"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request body",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required or invalid current password",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/repos": {
      "get": {
        "tags": ["Repositories"],
        "summary": "List user repositories",
        "description": "Returns all repositories owned by the authenticated user",
        "operationId": "listUserRepositories",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }],
        "responses": {
          "200": {
            "description": "List of repositories",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "repositories": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/RepoResponse"
                      }
                    },
                    "total": {
                      "type": "integer",
                      "example": 5
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Repositories"],
        "summary": "Create a repository",
        "description": "Creates a new repository for the authenticated user",
        "operationId": "createRepository",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateRepoRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Repository created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RepoResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request body or validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Repository already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/repos/public": {
      "get": {
        "tags": ["Repositories"],
        "summary": "List public repositories",
        "description": "Returns a paginated list of all public repositories",
        "operationId": "listPublicRepositories",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "Page number (starting from 1)",
            "schema": {
              "type": "integer",
              "default": 1,
              "minimum": 1
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "description": "Number of items per page",
            "schema": {
              "type": "integer",
              "default": 20,
              "minimum": 1,
              "maximum": 100
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of public repositories",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "repositories": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/RepoResponse"
                      }
                    },
                    "page": {
                      "type": "integer",
                      "example": 1
                    },
                    "per_page": {
                      "type": "integer",
                      "example": 20
                    },
                    "total": {
                      "type": "integer",
                      "example": 50
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/repos/{owner}/{repo}": {
      "get": {
        "tags": ["Repositories"],
        "summary": "Get a repository",
        "description": "Returns details of a specific repository",
        "operationId": "getRepository",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }, {}],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" }
        ],
        "responses": {
          "200": {
            "description": "Repository details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RepoResponse"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "patch": {
        "tags": ["Repositories"],
        "summary": "Update a repository",
        "description": "Updates repository settings (description, visibility)",
        "operationId": "updateRepository",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateRepoRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Repository updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RepoResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request body",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Permission denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Repositories"],
        "summary": "Delete a repository",
        "description": "Permanently deletes a repository",
        "operationId": "deleteRepository",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" }
        ],
        "responses": {
          "200": {
            "description": "Repository deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Repository deleted successfully"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Permission denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/repos/{owner}/{repo}/stats": {
      "get": {
        "tags": ["Repositories"],
        "summary": "Get repository statistics",
        "description": "Returns statistics for a specific repository",
        "operationId": "getRepositoryStats",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }, {}],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" }
        ],
        "responses": {
          "200": {
            "description": "Repository statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RepoStats"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/repos/{owner}/{repo}/branches": {
      "get": {
        "tags": ["Branches"],
        "summary": "List branches",
        "description": "Returns all branches in a repository",
        "operationId": "listBranches",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }, {}],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" }
        ],
        "responses": {
          "200": {
            "description": "List of branches",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BranchListResponse"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Branches"],
        "summary": "Create a branch",
        "description": "Creates a new branch from a specific commit",
        "operationId": "createBranch",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BranchRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Branch created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Branch created successfully"
                    },
                    "branch": {
                      "type": "string",
                      "example": "feature/new-feature"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request body",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Permission denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/repos/{owner}/{repo}/branches/{branch}": {
      "delete": {
        "tags": ["Branches"],
        "summary": "Delete a branch",
        "description": "Deletes a branch from the repository",
        "operationId": "deleteBranch",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" },
          {
            "name": "branch",
            "in": "path",
            "required": true,
            "description": "Branch name",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Branch deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Branch deleted successfully"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Permission denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Repository or branch not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/repos/{owner}/{repo}/tags": {
      "get": {
        "tags": ["Tags"],
        "summary": "List tags",
        "description": "Returns all tags in a repository",
        "operationId": "listTags",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }, {}],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" }
        ],
        "responses": {
          "200": {
            "description": "List of tags",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TagListResponse"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Tags"],
        "summary": "Create a tag",
        "description": "Creates a new tag pointing to a specific commit",
        "operationId": "createTag",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TagRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Tag created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Tag created successfully"
                    },
                    "tag": {
                      "type": "string",
                      "example": "v1.0.0"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request body",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Permission denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/repos/{owner}/{repo}/tags/{tag}": {
      "delete": {
        "tags": ["Tags"],
        "summary": "Delete a tag",
        "description": "Deletes a tag from the repository",
        "operationId": "deleteTag",
        "security": [{ "bearerAuth": [] }, { "basicAuth": [] }],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" },
          {
            "name": "tag",
            "in": "path",
            "required": true,
            "description": "Tag name",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tag deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Tag deleted successfully"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Permission denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Repository or tag not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/{owner}/{repo}/info/refs": {
      "get": {
        "tags": ["Git Protocol"],
        "summary": "Git info/refs",
        "description": "Git Smart HTTP protocol - capability advertisement",
        "operationId": "gitInfoRefs",
        "security": [{ "basicAuth": [] }, {}],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" },
          {
            "name": "service",
            "in": "query",
            "required": true,
            "description": "Git service type",
            "schema": {
              "type": "string",
              "enum": ["git-upload-pack", "git-receive-pack"]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Git refs info",
            "content": {
              "application/x-git-upload-pack-advertisement": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              },
              "application/x-git-receive-pack-advertisement": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Invalid service",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/{owner}/{repo}/git-upload-pack": {
      "post": {
        "tags": ["Git Protocol"],
        "summary": "Git upload-pack",
        "description": "Git Smart HTTP protocol - handles fetch/clone operations",
        "operationId": "gitUploadPack",
        "security": [{ "basicAuth": [] }, {}],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/x-git-upload-pack-request": {
              "schema": {
                "type": "string",
                "format": "binary"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Git pack data",
            "content": {
              "application/x-git-upload-pack-result": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "400": {
            "description": "Invalid content type",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/{owner}/{repo}/git-receive-pack": {
      "post": {
        "tags": ["Git Protocol"],
        "summary": "Git receive-pack",
        "description": "Git Smart HTTP protocol - handles push operations",
        "operationId": "gitReceivePack",
        "security": [{ "basicAuth": [] }],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/x-git-receive-pack-request": {
              "schema": {
                "type": "string",
                "format": "binary"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Push result",
            "content": {
              "application/x-git-receive-pack-result": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "400": {
            "description": "Invalid content type",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Permission denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/{owner}/{repo}/HEAD": {
      "get": {
        "tags": ["Git Protocol"],
        "summary": "Get HEAD reference",
        "description": "Git dumb HTTP protocol fallback - returns HEAD reference",
        "operationId": "gitGetHead",
        "security": [{ "basicAuth": [] }, {}],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" }
        ],
        "responses": {
          "200": {
            "description": "HEAD reference",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string",
                  "example": "ref: refs/heads/main"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/{owner}/{repo}/objects/info/packs": {
      "get": {
        "tags": ["Git Protocol"],
        "summary": "Get info/packs",
        "description": "Git dumb HTTP protocol - returns pack file information",
        "operationId": "gitGetInfoPacks",
        "security": [{ "basicAuth": [] }, {}],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" }
        ],
        "responses": {
          "200": {
            "description": "Pack information",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "404": {
            "description": "Repository not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/{owner}/{repo}/objects/{dir}/{file}": {
      "get": {
        "tags": ["Git Protocol"],
        "summary": "Get git object",
        "description": "Git dumb HTTP protocol - returns loose git object",
        "operationId": "gitGetObject",
        "security": [{ "basicAuth": [] }, {}],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" },
          {
            "name": "dir",
            "in": "path",
            "required": true,
            "description": "Object directory (first 2 chars of SHA)",
            "schema": {
              "type": "string",
              "minLength": 2,
              "maxLength": 2
            }
          },
          {
            "name": "file",
            "in": "path",
            "required": true,
            "description": "Object file (remaining 38 chars of SHA)",
            "schema": {
              "type": "string",
              "minLength": 38,
              "maxLength": 38
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Git object data",
            "content": {
              "application/x-git-loose-object": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "404": {
            "description": "Object not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/{owner}/{repo}/refs/heads/{branch}": {
      "get": {
        "tags": ["Git Protocol"],
        "summary": "Get branch ref",
        "description": "Git dumb HTTP protocol - returns branch reference",
        "operationId": "gitGetBranchRef",
        "security": [{ "basicAuth": [] }, {}],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" },
          {
            "name": "branch",
            "in": "path",
            "required": true,
            "description": "Branch name",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Branch reference",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "404": {
            "description": "Branch not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/{owner}/{repo}/refs/tags/{tag}": {
      "get": {
        "tags": ["Git Protocol"],
        "summary": "Get tag ref",
        "description": "Git dumb HTTP protocol - returns tag reference",
        "operationId": "gitGetTagRef",
        "security": [{ "basicAuth": [] }, {}],
        "parameters": [
          { "$ref": "#/components/parameters/owner" },
          { "$ref": "#/components/parameters/repo" },
          {
            "name": "tag",
            "in": "path",
            "required": true,
            "description": "Tag name",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tag reference",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "404": {
            "description": "Tag not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "JWT token authentication"
      },
      "basicAuth": {
        "type": "http",
        "scheme": "basic",
        "description": "HTTP Basic authentication (username/password)"
      }
    },
    "parameters": {
      "owner": {
        "name": "owner",
        "in": "path",
        "required": true,
        "description": "Repository owner username",
        "schema": {
          "type": "string"
        }
      },
      "repo": {
        "name": "repo",
        "in": "path",
        "required": true,
        "description": "Repository name",
        "schema": {
          "type": "string"
        }
      }
    },
    "schemas": {
      "RegisterRequest": {
        "type": "object",
        "required": ["username", "email", "password"],
        "properties": {
          "username": {
            "type": "string",
            "minLength": 3,
            "maxLength": 50,
            "example": "johndoe"
          },
          "email": {
            "type": "string",
            "format": "email",
            "example": "john@example.com"
          },
          "password": {
            "type": "string",
            "format": "password",
            "minLength": 8,
            "example": "secretpassword123"
          }
        }
      },
      "RegisterResponse": {
        "type": "object",
        "properties": {
          "user": {
            "$ref": "#/components/schemas/UserInfo"
          },
          "message": {
            "type": "string",
            "example": "User registered successfully"
          }
        }
      },
      "UserInfo": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "username": {
            "type": "string",
            "example": "johndoe"
          },
          "email": {
            "type": "string",
            "format": "email",
            "example": "john@example.com"
          },
          "is_admin": {
            "type": "boolean",
            "example": false
          }
        }
      },
      "ChangePasswordRequest": {
        "type": "object",
        "required": ["current_password", "new_password"],
        "properties": {
          "current_password": {
            "type": "string",
            "format": "password",
            "example": "oldpassword123"
          },
          "new_password": {
            "type": "string",
            "format": "password",
            "minLength": 8,
            "example": "newpassword456"
          }
        }
      },
      "CreateRepoRequest": {
        "type": "object",
        "required": ["name"],
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 100,
            "pattern": "^[a-zA-Z0-9._-]+$",
            "example": "my-awesome-project"
          },
          "description": {
            "type": "string",
            "maxLength": 500,
            "example": "A description of my project"
          },
          "is_private": {
            "type": "boolean",
            "default": false,
            "example": false
          }
        }
      },
      "UpdateRepoRequest": {
        "type": "object",
        "properties": {
          "description": {
            "type": "string",
            "maxLength": 500,
            "example": "Updated description"
          },
          "is_private": {
            "type": "boolean",
            "example": true
          }
        }
      },
      "RepoResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "name": {
            "type": "string",
            "example": "my-awesome-project"
          },
          "owner": {
            "type": "string",
            "example": "johndoe"
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "example": "550e8400-e29b-41d4-a716-446655440001"
          },
          "is_private": {
            "type": "boolean",
            "example": false
          },
          "description": {
            "type": "string",
            "example": "A description of my project"
          },
          "clone_url": {
            "type": "string",
            "format": "uri",
            "example": "http://localhost:8080/johndoe/my-awesome-project.git"
          },
          "ssh_url": {
            "type": "string",
            "example": "git@localhost:johndoe/my-awesome-project.git"
          },
          "git_path": {
            "type": "string",
            "example": "/data/repos/johndoe/my-awesome-project.git"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "example": "2024-01-15T10:30:00Z"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "example": "2024-01-15T10:30:00Z"
          }
        }
      },
      "RepoStats": {
        "type": "object",
        "properties": {
          "commits": {
            "type": "integer",
            "example": 150
          },
          "branches": {
            "type": "integer",
            "example": 5
          },
          "tags": {
            "type": "integer",
            "example": 3
          },
          "contributors": {
            "type": "integer",
            "example": 10
          },
          "size_bytes": {
            "type": "integer",
            "format": "int64",
            "example": 1048576
          }
        }
      },
      "BranchRequest": {
        "type": "object",
        "required": ["name", "commit_hash"],
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 255,
            "example": "feature/new-feature"
          },
          "commit_hash": {
            "type": "string",
            "minLength": 40,
            "maxLength": 40,
            "pattern": "^[a-f0-9]{40}$",
            "example": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0"
          }
        }
      },
      "BranchResponse": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "example": "main"
          },
          "hash": {
            "type": "string",
            "example": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0"
          },
          "is_head": {
            "type": "boolean",
            "example": true
          }
        }
      },
      "BranchListResponse": {
        "type": "object",
        "properties": {
          "branches": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BranchResponse"
            }
          },
          "total": {
            "type": "integer",
            "example": 5
          }
        }
      },
      "TagRequest": {
        "type": "object",
        "required": ["name", "commit_hash"],
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 255,
            "example": "v1.0.0"
          },
          "commit_hash": {
            "type": "string",
            "minLength": 40,
            "maxLength": 40,
            "pattern": "^[a-f0-9]{40}$",
            "example": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0"
          },
          "message": {
            "type": "string",
            "description": "If provided, creates an annotated tag",
            "example": "Release version 1.0.0"
          }
        }
      },
      "TagResponse": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "example": "v1.0.0"
          },
          "hash": {
            "type": "string",
            "example": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0"
          },
          "message": {
            "type": "string",
            "example": "Release version 1.0.0"
          },
          "tagger": {
            "type": "string",
            "example": "John Doe <john@example.com>"
          },
          "is_annotated": {
            "type": "boolean",
            "example": true
          }
        }
      },
      "TagListResponse": {
        "type": "object",
        "properties": {
          "tags": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TagResponse"
            }
          },
          "total": {
            "type": "integer",
            "example": 3
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "example": "not_found"
          },
          "message": {
            "type": "string",
            "example": "Repository not found"
          },
          "details": {
            "type": "string",
            "example": "Additional error details"
          }
        }
      }
    }
  }
}
